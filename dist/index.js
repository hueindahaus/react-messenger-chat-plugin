"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("prop-types");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=o(e),s=o(t);let r=!1,i=!1;const g=({pageId:t,language:o="en_US",themeColor:s,height:g,autoExpand:l=!0,loggedInGreeting:c,loggedOutGreeting:u,ref:d,onMessengerMounted:h,onMessengerLoad:m,onMessengerShow:f,onMessengerHide:b,onMessengerDialogShow:p,onMessengerDialogHide:w,debugMode:y=!1,version:C="v11.0"})=>{const E=()=>{y&&console.log("[react-messenger-chat-plugin] expanding on init");try{const e=JSON.parse(localStorage.getItem("__fb_chat_plugin")),t="navigate"!==performance?.getEntriesByType("navigation")[0]?.type;e&&"hidden"===e?.visibility&&!t&&FB.CustomerChat.show()}catch(e){throw console.warn("Probblem when autoexpanding messenger chatbox occured. Please file an issue on github."),new Error(e)}};return e.useEffect((()=>{try{i=y,(()=>{y&&console.log("[react-messenger-chat-plugin] initializing messenger plugin");try{const e=document.getElementById("fb-customer-chat");e.setAttribute("page_id",t),e.setAttribute("attribution","biz_inbox"),s&&e.setAttribute("theme_color",s),c&&e.setAttribute("logged_in_greeting",c),u&&e.setAttribute("logged_out_greeting",u),l?(e.setAttribute("greeting_dialog_display","show"),e.setAttribute("greeting_dialog_delay",0)):e.setAttribute("greeting_dialog_display","hide"),d&&e.setAttribute("ref",d),window.fbAsyncInit=function(){FB.init({xfbml:!0,version:C}),FB.Event.subscribe("customerchat.load",(()=>{m&&m()})),FB.Event.subscribe("xfbml.render",(()=>{void 0!==g&&a(g),l&&setTimeout(E,3e3),h&&h(),r=!0})),FB.Event.subscribe("customerchat.show",(()=>{f&&f()})),FB.Event.subscribe("customerchat.hide",(()=>{b&&b()})),FB.Event.subscribe("customerchat.dialogShow",(()=>{p&&p()})),FB.Event.subscribe("customerchat.dialogHide",(()=>{w&&w()}))},function(e,t,n){let s,r=e.getElementsByTagName(t)[0];e.getElementById(n)||(s=e.createElement(t),s.id=n,s.src=`https://connect.facebook.net/${o}/sdk/xfbml.customerchat.js`,r.parentNode.insertBefore(s,r))}(document,"script","facebook-jssdk")}catch(e){throw e}})()}catch(e){console.log(e)}})),n.default.createElement("div",null,n.default.createElement("div",{id:"fb-root"}),n.default.createElement("div",{id:"fb-customer-chat",className:"fb-customerchat"}))},a=e=>{i&&console.log(`[react-messenger-chat-plugin] setting messenger height: ${e}`);const t=document.getElementsByClassName("fb_customer_chat_icon");if(t&&t.length>0){t[0].style.bottom=`${e}px`}else console.warn("Could not set height of messenger button.");const o=document.getElementsByClassName("anchor_right");if(t&&o.length>0){o[0].style.bottom=`${e+56}px`}else console.warn("Could not set height of messenger dialog container.")};g.propTypes={pageId:s.default.string.isRequired,language:s.default.string,themeColor:s.default.string,height:s.default.number,autoExpand:s.default.bool,loggedInGreeting:s.default.string,loggedOutGreeting:s.default.string,ref:s.default.string,onMessengerMounted:s.default.func,onMessengerLoad:s.default.func,onMessengerShow:s.default.func,onMessengerHide:s.default.func,onMessengerDialogShow:s.default.func,onMessengerDialogHide:s.default.func,debugMode:s.default.bool,version:s.default.string,custom:function(e){console.log(e);const t=e.themeColor;if(t&&!/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(t))return new Error("Invalid hexcolor format on prop: themeColor")}},exports.MessengerChat=g,exports.hideDialog=()=>{i&&console.log("[react-messenger-chat-plugin] hiding dialog");try{r&&FB?.CustomerChat?FB.CustomerChat.hideDialog():r||console.warn("Messenger could not hide dialog due to the messenger chat not beeing mounted yet.")}catch(e){throw new Error(e)}},exports.hideMessenger=(e=!1)=>{i&&console.log("[react-messenger-chat-plugin] hiding messenger with argument");try{r&&FB?.CustomerChat?FB.CustomerChat.hide():r||console.warn("Messenger could not hide messenger due to the messenger chat not beeing mounted yet.")}catch(e){throw new Error(e)}},exports.setMessengerHeight=a,exports.showDialog=()=>{i&&console.log("[react-messenger-chat-plugin] showing dialog");try{r&&FB?.CustomerChat?FB.CustomerChat.showDialog():r||console.warn("Messenger could not show dialog due to the messenger chat not beeing mounted yet.")}catch(e){throw new Error(e)}},exports.showMessenger=e=>{i&&console.log(`[react-messenger-chat-plugin] showing messenger with argument "shouldShowDialog": ${e}`);try{r&&FB?.CustomerChat?FB.CustomerChat.show(e):r||console.warn("Messenger could not expand messenger due to the messenger chat not beeing mounted yet.")}catch(e){throw new Error(e)}};
